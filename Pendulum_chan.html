<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Маятник</title>
  <link rel="stylesheet" href="style.css">
</head>

<body>
  <canvas id="canvas" width="400" height="400">
       </canvas>

  <script src="Point.js"></script>
  <script src="Vector.js"></script>
  <script src="Cube.js"></script>
  <!--script src="Dot.js"></script-->
  <script src="Pendulum_chan.js"></script>
  
  <script>


    window.onload = function() {
      var canvas = document.getElementById("canvas"),
        context = canvas.getContext("2d"),
        x0 = canvas.width / 2,
        y0 = canvas.height / 2;
      context.translate(x0, y0);

      // Установка первоначальной длины маятника
      var lengthPendulum = document.getElementById("lengthPendulum");
      var lengthPendulumValue = lengthPendulum.value;
      console.log('Первоначально установленная длина маятника: ' + lengthPendulumValue);

      // - - - - - - - - - - - - - - - - - - - - - - - - - - -
      p = new Point (0, -100, 0);
      pendulum = new Pendulum(p, 200, 30);
      var phase = 0;

        pendulum.draw(context);

      (function drawFrame() {
        window.requestAnimationFrame(drawFrame, canvas);
        context.clearRect(-x0, -y0, canvas.width, canvas.height);

        if (phase >= 360)
          {phase = phase - 360}
        a1 = phase * Math.PI / 180;
        angle = 20 * Math.sin(a1);
        pendulum.setAngle(angle);
        pendulum.plummet.rotate(pendulum.plummet.center, 0, phase, phase);
        pendulum.draw2(context);
        phase = phase + 3;
      }());
      // - - - - - - - - - - - - - - - - - - - - - - - - - - -

      // Установка события на изменение длины маятника
      function selectLengthPendulum()
      {
        pendulum.length = lengthPendulum.value;
        console.log('Изменённая длина маятника: ' + lengthPendulum.value);
      }
      lengthPendulum.addEventListener('change', selectLengthPendulum, false );

      // Установка длины маятника через ползунок
      var input = document.getElementById('lengthPendulum2');
      
      function selectLengthPendulum2()
      {
        pendulum.length = input.value;
        console.log('Изменённая длина маятника: ' + input.value);
      }
      
      input.addEventListener('change', selectLengthPendulum2, false);


    }
  </script>

  <form>
    <label for="lengthPendulum" > Выберите длину маятника: </label>
    <select id="lengthPendulum" >
      <option value="100">100px</option>
      <option value="200"  selected="selected">200px</option>
      <option value="300">300px</option>
    </select>
  </form>
  <hr />
  <form>
  <p>Изменение длины маятника ( в pixel ) от 50 до 400 с шагом i=50 </p>
  <p>
    <input id="lengthPendulum2" type="range" min="50" max="400" step="50">
  </p>
  </form>

</body>

</html>
